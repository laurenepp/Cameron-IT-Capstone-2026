# ============================================================
# .htaccess - Apache Security Configuration
# ============================================================
# This file goes in the ROOT of your project (same level as index.php).
# Apache reads it automatically - you don't need to call it in PHP.
#
# What this does:
#   - Prevents people from browsing your folder structure
#   - Blocks direct access to your PHP config files
#   - Adds security headers to every page
#   - Prevents common attack vectors
# ============================================================

# --- Disable Directory Listing ---
# Without this, going to http://localhost/images/ would show ALL your files
Options -Indexes

# --- Security Headers ---
# These tell the browser to be extra careful
<IfModule mod_headers.c>
    # Prevents your site from being loaded inside an iframe (stops clickjacking)
    Header always set X-Frame-Options "DENY"
    
    # Prevents browser from guessing file types (stops MIME sniffing attacks)
    Header always set X-Content-Type-Options "nosniff"
    
    # Enables browser's built-in XSS filter
    Header always set X-XSS-Protection "1; mode=block"
    
    # Removes the "Powered by PHP" header that reveals your tech stack
    Header always unset X-Powered-By
</IfModule>

# --- Protect Sensitive Files ---
# These files should NEVER be accessible via browser URL
<FilesMatch "(config\.php|config\.sample\.php|\.env|\.gitignore)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# --- Block Access to Hidden Files ---
# Files starting with . (like .gitignore, .htaccess itself)
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# --- Block PHP Execution in the Images Folder ---
# Prevents someone from uploading a malicious .php file disguised as an image
<Directory "images">
    php_flag engine off
</Directory>

# --- Error Pages ---
# Don't show Apache's default error pages (they reveal server info)
# TODO: Create these pages later
# ErrorDocument 403 /error/403.php
# ErrorDocument 404 /error/404.php

# --- Prevent Access to Backup Files ---
# Blocks .bak, .sql, .log files from being downloaded
<FilesMatch "\.(bak|sql|log|sh|inc|swp|dist)$">
    Order allow,deny
    Deny from all
</FilesMatch>
